{% extends "base.html" %}
{% load static %}
{% block title %}{{turma.name}}{% endblock %}
{% block javascript %}
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.min.css">
{% endblock %}
{% block content %}
	<!-- <div class="card">
		<div class="card-header text-white" style="background-color: #500000;">
			{% if user.gender == 'MASCULINO' %}
				Bem-vindo {{user.name}}!
			{% elif user.gender == 'FEMININO' %}
				Bem-vinda {{user.name}}
			{% endif %}
			{% if turma.responsible.gender == 'MASCULINO' %}
				Você está na turma {{turma.name}} do professor {{turma.responsible}}!
			{% else %}
				Você está na turma {{turma.name}} da professora {{turma.responsible}}!
			{% endif %}
		</div>
		<div class="card-body">
			Busque por um tema para encontrá-lo com mais facilidade
			<form method="POST">
				{% csrf_token %}
				<div class="form-group">
					<input type="text" name="search" placeholder="Encontrar um tema..." class="searchbar">
					<input type="submit" value="Buscar" name="btnsearch" class="btn text-white" style="background-color: #500000;"/>
				</div>
			</form>
		</div>
	</div> -->
	<div class="card">
		<div class="card-header bg-dark text-white">
			Turma {{turma}}
		</div>
		<div class="card-body">
			{% if user == turma.responsible %}
			<div>
				<button class="btn bg-dark text-white" id="btn_conteudos">Conteúdos</button>
				<button class="btn bg-dark text-white" id="btn_alunos">Gerenciar Alunos</button>
			</div>
			{% endif %}
			<div class="card" id="conteudos">
				<div class="card-header bg-dark text-white">
					Conteúdos
				</div>
				<div class="card-body">
					{% for tema in temas %}
						<div class="card">
							<div class="card-header bg-dark text-white">
								{{ tema.name }}
								{% if user.user_type == 'PROFESSOR' %}
								<a href="{% url 'excluir_tema' tema.pk %}" class="close text-white" aria-label="Excluir tema">&times;</a>
								{% endif %}
							</div>
							<div class="card-body">
								Professor: {{ tema.responsible }}<br>
								Atualizado pela última vez em: {{ tema.updated_at }}<br>
								<br>
								<a href="{% url 'tema' tema.pk %}" class="btn btn-success">Acessar Conteúdo</a><br>
								<a href="{% url 'forum' pk=tema.pk %}" >Acessar o fórum de dúvidas</a>
							</div>
						</div>
					{% empty %}
						<div>
							Nenhum conteúdo disponível...
						</div>
						<br>
					{% endfor %}
				
					{% if user.user_type == 'PROFESSOR' %}
						<a href="{% url 'vincular_conteudos' turma.pk %}" class="btn bg-dark text-white">Vincular um conteúdo já existente</a>
						<a href="{% url 'criar_tema' turma.pk %}" class="btn bg-dark text-white">Criar novo conteúdo</a>
					{% endif %}
				</div>
			</div>
			{% if user == turma.responsible %}
			<div class="card" id="alunos">
				<div class="card-header bg-dark text-white">
					Gerenciar alunos
				</div>
				<div class="card-body">
					Selecione um aluno para matriculá-lo nesta turma.
					<form method="POST">
						{% csrf_token %}
						<div class="form-group">
							<select class="chosen searchbar" multiple name="alunos">
								<option value=""></option>
								{% for aluno in alunos %} 
								<option value={{aluno.pk}}>"{{aluno.name}} "{{aluno.email}}"</option>
								{% endfor %}
							</select>
						</div>
						<input type="submit" value="Matricular" class="btn bg-dark text-white" name="btnmatricula"/><br>
						<a href="{% url 'listar_alunos' turma.pk %}">Ver alunos já matriculados</a>
					</form>
				</div>
			</div>
			{% endif %}
			<button class="btn btn-danger" onclick="goBack()">Voltar</button>
		</div>
	</div>
	<script type="text/javascript">
		$(".chosen").chosen({
			no_results_text: "Sem resultados para",
    		placeholder_text_single: "Selecione um aluno",
    		placeholder_text_multiple: "Selecione os alunos"
		})
	</script>
	<script type="text/javascript" src="{% static 'js/turma.js' %}"></script>
{% endblock %}